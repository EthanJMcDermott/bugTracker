{% extends "base_layout.html" %}
{% block content %}
    <script>
        $(document).ready(function(){
            $("#mobile-nav-btn").click(function() {
                $("#mobile-nav").toggle();
            })
            $("#openForm").click(function() {
                $("#cover").toggle()
                $("#addProject").toggle()
            })
            $(".close-form").click(function() {
                $("#cover").toggle()
                $("#addProject").toggle()
            })
        })
    </script>
    <div id=cover></div>
    <div class="container">

        {% include "header.html" %}

        <div class="sub-header box-shadow">
            <h2>My Projects</h2>
        </div>
        <div class="add-project-container">
            {% if request.session.role in admin %}
            <button class="open-form" id="openForm" onclick="openForm()">Create New Project</button>
            {% endif %}
            <div class="add-project" id="addProject">
                <form action="/projects/add" method="post">
                    {% csrf_token %}
                    <label for="title">Project Title: </label>
                    <input type="text" name="title">
                    <label for="description">Project Description</label>
                    <textarea name="description" cols="30" rows="10"></textarea>
                    <label for="project_manager">Select Project Manager</label>
                    <select name="project_manager">
                        <option value=""></option>
                        {% for user in users %}
                        <option value="{{ user.id }}">{{ user.first_name }} {{ user.last_name }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="submit">Create</button>
                </form>
                <button class="close-form" onclick="closeForm()">Close</button>
            </div>
        </div>
        <div class="projects">
            {% for project in projects %}
            {% if this_user in project.users.all or this_user.role == 3%}
            <div class="individual-project box-shadow">
                <h3>{{ project.title }}</h3>
                <h4>Project Manager | {{ project.project_manager.first_name }} {{ project.project_manager.last_name }}</h4>
                <p class="project-description">{{ project.description }}</p>
                <p class="project-footer">Created on: {{ project.created_at }} <br>
                Created by: {{ project.created_by.first_name }} {{ project.created_by.last_name }} </p>
                <a href="/projects/{{ project.id }}">View Project</a>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
{% endblock %}